<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
    <link rel="stylesheet" href="/docs/assets/css/main.css" />
    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    <script>
    (function(canonical) {
      if (document.location.href.substr(0, document.location.href.length - document.location.hash.length) !== canonical) {
        window.location.replace(canonical);
      }
    })('https://www.thethingsnetwork.org/docs/gateways/packet-forwarder/ttn.html');
    </script>
    <!-- Begin Jekyll SEO tag v2.4.0 -->
<title>TTN Packet Forwarder | The Things Network</title>
<meta name="generator" content="Jekyll v3.4.5" />
<meta property="og:title" content="TTN Packet Forwarder" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="TTN Packet Forwarder" />
<meta property="og:description" content="TTN Packet Forwarder" />
<link rel="canonical" href="https://www.thethingsnetwork.org/docs/gateways/packet-forwarder/ttn.html" />
<meta property="og:url" content="https://www.thethingsnetwork.org/docs/gateways/packet-forwarder/ttn.html" />
<meta property="og:site_name" content="The Things Network" />
<meta property="og:image" content="https://www.thethingsnetwork.org/docs/assets/images/og-image.png" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2018-04-29T14:23:36+00:00" />
<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:site" content="@thethingsnetwrk" />
<meta property="article:publisher" content="https://www.facebook.com/thethingsnetwork" />
<script type="application/ld+json">
{"description":"TTN Packet Forwarder","url":"https://www.thethingsnetwork.org/docs/gateways/packet-forwarder/ttn.html","headline":"TTN Packet Forwarder","dateModified":"2018-04-29T14:23:36+00:00","datePublished":"2018-04-29T14:23:36+00:00","@type":"BlogPosting","image":"https://www.thethingsnetwork.org/docs/assets/images/og-image.png","publisher":{"@type":"Organization","logo":{"@type":"ImageObject","url":"https://ttnstaticfile.blob.core.windows.net/static/common/favicon/largetile.png"}},"mainEntityOfPage":{"@type":"WebPage","@id":"https://www.thethingsnetwork.org/docs/gateways/packet-forwarder/ttn.html"},"@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->
    <link rel="apple-touch-icon-precomposed" href="https://ttnweb.azureedge.net/static/common/favicon/favicon-152.6c70a98e264d.png">
    <meta name="msapplication-TileColor" content="#FFFFFF">
    <meta name="msapplication-TileImage" content="https://ttnweb.azureedge.net/static/common/favicon/favicon-144.61bd01a950fb.png">
    <meta name="application-name" content="The Things Network">
    <meta name="msapplication-tooltip" content="Tooltip">
    <meta name="msapplication-config" content="https://ttnweb.azureedge.net/static/common/favicon/ieconfig.54334a5ee30c.xml">
    <link rel="icon" href="https://ttnweb.azureedge.net/static/common/favicon/favicon-32.61b30f85680a.png" sizes="32x32">
    <link rel="icon" href="https://ttnweb.azureedge.net/static/common/favicon/favicon-57.83b86c64dc82.png" sizes="57x57">
    <link rel="icon" href="https://ttnweb.azureedge.net/static/common/favicon/favicon-76.7dcf8fa36dfc.png" sizes="76x76">
    <link rel="icon" href="https://ttnweb.azureedge.net/static/common/favicon/favicon-96.27ac17adaa8b.png" sizes="96x96">
    <link rel="icon" href="https://ttnweb.azureedge.net/static/common/favicon/favicon-120.e1526731335e.png" sizes="120x120">
    <link rel="icon" href="https://ttnweb.azureedge.net/static/common/favicon/favicon-128.fabea041224c.png" sizes="128x128">
    <link rel="icon" href="https://ttnweb.azureedge.net/static/common/favicon/favicon-144.61bd01a950fb.png" sizes="144x144">
    <link rel="icon" href="https://ttnweb.azureedge.net/static/common/favicon/favicon-152.6c70a98e264d.png" sizes="152x152">
    <link rel="icon" href="https://ttnweb.azureedge.net/static/common/favicon/favicon-180.fcd414307ca3.png" sizes="180x180">
    <link rel="icon" href="https://ttnweb.azureedge.net/static/common/favicon/favicon-195.c55ce09d66da.png" sizes="195x195">
    <link rel="icon" href="https://ttnweb.azureedge.net/static/common/favicon/favicon-228.bea53ec4b10b.png" sizes="228x228">
    <link rel="icon" href="https://ttnweb.azureedge.net/static/common/favicon/smalltile.fabea041224c.png" sizes="128x128">
    <link rel="icon" href="https://ttnweb.azureedge.net/static/common/favicon/mediumtile.3d42f7faac82.png" sizes="270x270">
    <link rel="icon" href="https://ttnweb.azureedge.net/static/common/favicon/widetile.3d42f7faac82.png" sizes="558x270">
    <link rel="icon" href="https://ttnweb.azureedge.net/static/common/favicon/largetile.eb144ebab4d1.png" sizes="558x558">
    <link rel="shortcut icon" sizes="196x196" href="https://ttnweb.azureedge.net/static/common/favicon/favicon-196.277278d69ddc.png">
    <script src="/docs/assets/js/main.js"></script>
  </head>
  <body>
    <div id="header"></div>
    <div id="content">
<div class="layout-page">
  <div class="ttn-header ttn-header-small">
    <div class="ttn-container container-fluid">
      <h1>
        <img src="/docs/assets/images/the-things-white.png" alt="⛅ The Things Network" />
        <span>Learn</span>
      </h1>
    </div>
  </div>
  <div class="container-fluid ttn-container">
    <div class="row page-top-nav">
      <div class="col-sm-9">
        <ul>
          <li class="page-top-nav-crumb"><a href="http://www.thethingsnetwork.org/">Home</a></li>
          <li class="page-top-nav-crumb"><a href="/docs/">Learn</a></li>
                <li class=""><a href="/docs/lorawan/">LoRaWAN</a></li>
                <li class=""><a href="/docs/devices/">Devices</a></li>
                <li class="active"><a href="/docs/gateways/">Gateways</a></li>
                <li class=""><a href="/docs/network/">Network</a></li>
                <li class=""><a href="/docs/applications/">Applications</a></li>
        </ul>
      </div>
      <div class="hidden-xs col-sm-3 text-right">
        <a href="https://github.com/TheThingsNetwork/docs/edit/master/_content/gateways/packet-forwarder/ttn.md" class="page-edit" data-proofer-ignore><i class="fa fa-github"></i> Edit <strong>ttn.md</strong></a>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-3">
        <div class="panel page-side-nav page-affix">
          <div class="panel-body">
            <h5>Gateways</h5>
            <ul>
              <li class=""><a href="/docs/gateways/index.html">Overview</a>
              </li>
            <li class="page-side-nav-section"><span>Running a gateway</span>
            <ul>
                <li class=""><a href="/docs/gateways/start/">Where to start</a>
                </li>
                <li class=""><a href="/docs/gateways/registration.html">Gateway Registration</a>
                </li>
                <li class=""><a href="/docs/gateways/packet-forwarder/">Packet Forwarders</a>
            <ul>
                <li class=""><a href="/docs/gateways/packet-forwarder/semtech-udp.html">Semtech UDP Packet Forwarder</a>
                </li>
                <li class="active"><a href="/docs/gateways/packet-forwarder/ttn.html">TTN Packet Forwarder</a>
                </li>
            </ul>
                </li>
                <li class=""><a href="/docs/gateways/lightning-protection.html">Lightning Protection</a>
                </li>
                <li class=""><a href="/docs/gateways/troubleshooting/">Troubleshooting</a>
                </li>
            </ul>
            </li>
            <li class="page-side-nav-section"><span>Hardware</span>
            <ul>
                <li class=""><a href="/docs/gateways/gateway/">The Things Gateway</a>
                </li>
                <li class=""><a href="/docs/gateways/multitech/">MultiTech Conduit</a>
                </li>
                <li class=""><a href="/docs/gateways/rak831/">RAK831</a>
                </li>
                <li class=""><a href="/docs/gateways/kerlink/">Kerlink LoRa IoT Station</a>
                </li>
                <li class=""><a href="/docs/gateways/lorrier/">Lorrier LR2</a>
                </li>
            </ul>
            </li>
            </ul>
          </div>
        </div>
      </div>
      <div class="col-sm-7">
        <div class="panel">
          <div class="panel-body page-content">
            <h1 id="ttn-packet-forwarder">TTN Packet Forwarder</h1>
<p><strong>⚠️ The development of this packet forwarder has been put on hold. We’re currently working on new tools to make gateways easier to manage, that we will make public when ready. In the meanwhile, we recommend to use other packet forwarders (e.g. the <a href="semtech-udp.html">Semtech UDP Packet Forwarder</a>). To learn more, join the discussion on <a href="https://www.thethingsnetwork.org/forum/t/new-ttn-packet-forwarder-available/7644/46">the forum</a>.</strong></p>
<p>The TTN Packet Forwarder is a new packet forwarder, developed by the Things Network Core Team in Go. Builds for a selection of gateways, and documentation on how it is built, is available <a href="https://github.com/TheThingsNetwork/packet_forwarder">on GitHub</a>. Among the features of this packet forwarder:</p>
<ul>
  <li>
    <p>Built in <a href="https://golang.org">Golang</a> and open-source</p>
  </li>
  <li>
    <p>Connects with the <a href="../start/connection.html#gateway-connector-protocol">Gateway Connector protocol</a>: authentified, reliable and encrypted</p>
  </li>
  <li>
    <p>Pre-built for multiple gateways, and build instructions available for all SPI LoRa gateways</p>
  </li>
</ul>
<h2 id="installation">Installation</h2>
<p>Currently, we have installation guides available to install the packet forwarder for <a href="https://github.com/TheThingsNetwork/packet_forwarder/blob/master/docs/INSTALL_INSTRUCTIONS/MULTITECH.md">Multitech Conduit</a>, <a href="https://github.com/TheThingsNetwork/packet_forwarder/blob/master/docs/INSTALL_INSTRUCTIONS/KERLINK.md">Kerlink IoT Station</a> and <a href="https://github.com/TheThingsNetwork/packet_forwarder/blob/master/docs/INSTALL_INSTRUCTIONS/IMST_RPI.md">Raspberry Pi + iC880a</a> setups.</p>
<p>We will be adding more gateways over time. In the meantime, if you have a different gateway, we have documentation available to help you <a href="https://github.com/TheThingsNetwork/packet_forwarder/blob/master/docs/INSTALL_INSTRUCTIONS/SPI.md">build the packet forwarder</a> for your own gateway. The TTN Packet Forwarder being open-source, please feel free to contribute with new documentation!</p>
<h2 id="configuration">Configuration</h2>
<p>The TTN Packet Forwarder is configured through a configuration file. The location file’s default location is <code class="highlighter-rouge">$HOME/.pktfwd.yml</code>, but can be located in different locations in our pre-built packages:</p>
<ul>
  <li>
    <p>In the Multitech Conduit package, it is located at the <code class="highlighter-rouge">/usr/cfg/config.yml</code> path.</p>
  </li>
  <li>
    <p>In the Kerlink IoT Station package, it is located at the <code class="highlighter-rouge">/mnt/fsuser-1/ttn-pkt-fwd/config.yml</code> path.</p>
  </li>
</ul>
<p>For in-depth configuration, all the paths are available <a href="https://github.com/TheThingsNetwork/packet_forwarder#run">in the GitHub documentation</a>.</p>
<h3 id="change-gateway-id-and-key">Change Gateway ID and key</h3>
<p>To change the gateway’s ID and key, edit the configuration file, and set those values:</p>
<div class="language-yaml highlighter-rouge"><pre class="highlight"><code><span class="s">id</span><span class="pi">:</span> <span class="s">&lt;New gateway ID&gt;</span>
<span class="s">key</span><span class="pi">:</span> <span class="s">&lt;New gateway key&gt;</span>
</code></pre>
</div>
<h3 id="configure-on-a-private-network">Configure on a private network</h3>
<p>To configure the gateway to connect on a network that is <strong>not</strong> the public community network, set those values in the configuration:</p>
<div class="language-yaml highlighter-rouge"><pre class="highlight"><code><span class="s">discovery-server</span><span class="pi">:</span> <span class="s">&lt;Hostname of the private network&gt;:&lt;Port of the discovery server&gt;</span>
<span class="s">auth-server</span><span class="pi">:</span> <span class="s">&lt;URL of the account server&gt;</span>
</code></pre>
</div>
<p>For example, if you have a private network at <code class="highlighter-rouge">&lt;privatenetwork&gt;.thethings.industries</code> with a default configuration, you will configure the packet forwarder on:</p>
<div class="language-yaml highlighter-rouge"><pre class="highlight"><code><span class="s">discovery-server</span><span class="pi">:</span> <span class="s">&lt;privatenetwork&gt;.thethings.industries:1900</span>
<span class="s">auth-server</span><span class="pi">:</span> <span class="s">https://account.&lt;privatenetwork&gt;.thethings.industries</span>
</code></pre>
</div>
<h3 id="configure-on-a-specific-router">Configure on a specific router</h3>
<p>If you want your packet forwarder to connect to a specific router, you can specify it in the packet forwarder’s configuration:</p>
<div class="language-yaml highlighter-rouge"><pre class="highlight"><code><span class="s">router</span><span class="pi">:</span> <span class="s">&lt;ID of the router&gt;</span>
</code></pre>
</div>
<h2 id="troubleshooting">Troubleshooting</h2>
<p>Here are some common errors that can happen with the TTN Packet Forwarder, and tips on how to solve them:</p>
<h3 id="dial-tcp-lookup-error"><code class="highlighter-rouge">dial tcp: lookup</code> error</h3>
<div class="highlighter-rouge"><pre class="highlight"><code>FATAL Couldn't read configuration              error=Get https://account.thethingsnetwork.org/api/v2/gateways/test-gateway: dial tcp: lookup account.thethingsnetwork.org on [::1]:53: read udp [::1]:46876-&gt;[::1]:53: read: connection refused
</code></pre>
</div>
<p><em>Example of this error happening</em></p>
<p>This error happens when the gateway fails to complete a DNS lookup for the account server. It can happen for these reasons:</p>
<ul>
  <li>
    <p>Your gateway <strong>doesn’t have access to Internet</strong> or to its DNS server. To verify if your gateway has access to Internet, the easiest way is to execute <code class="highlighter-rouge">ping 8.8.8.8</code>. If there is an answer, your gateway is certainly connected. You’ll also want to make sure that if you’re behind a firewall, it isn’t blocking DNS resolutions.</p>
  </li>
  <li>
    <p>There is <strong>no DNS server configured</strong> on the gateway. The resolution method for this issue varies from gateway to gateway - for most Linux-based gateways, it can be resolved by configuring Google’s DNS servers. Edit the <code class="highlighter-rouge">/etc/resolv.conf</code> file, and fill it with this:</p>
  </li>
</ul>
<div class="highlighter-rouge"><pre class="highlight"><code>nameserver 8.8.8.8
nameserver 8.8.4.4
</code></pre>
</div>
<h3 id="failed-to-load-system-roots-and-no-roots-provided">Failed to load system roots and no roots provided</h3>
<p>This error can happen to gateways that <strong>aren’t provisioned with any <a href="https://www.globalsign.com/en/ssl-information-center/what-are-certification-authorities-trust-hierarchies/">root SSL certificates</a></strong>. Root certificates are used by the system to verify the identity of websites and servers that use SSL certificates to identify themselves. If your system doesn’t have any root certificate, the packet forwarder <strong>cannot verify the identity of the servers</strong> you’re communicating with, and fails as a <strong>security measure</strong>.</p>
<p>To fix this issue, make sure that your gateway’s firmware is up to date. You’ll then need to download to your system the right root certificate. In the case of The Things Network, you will need to download the <strong>latest active <a href="https://letsencrypt.org/certificates/">Let’s Encrypt root certificate</a></strong>.</p>
<p>Once you’ve downloaded it, you’ll need to register it in your system. For most Linux-based gateways, you’ll just need to copy the root certificate inside the root certificates directory <code class="highlighter-rouge">/etc/ssl/certs</code>. It can however vary - for example, the procedure is different for <a href="http://wiki.cacert.org/FAQ/ImportRootCert#Debian">Debian-based Linux distributions</a>.</p>
<h3 id="certificate-is-valid-for--not-for-">Certificate is valid for […], not for […]</h3>
<p>This is another SSL certificates error, which can happen if you’re setting up your own routing services. SSL certificates is valid for a given <strong>domain</strong> - if you’re trying to use it for a different domain, the verification of the certificate will fail. Make sure that the domain you’ve configured your network at matches the domain of your certificate.</p>
<h3 id="failed-to-start-concentrator">Failed to start concentrator</h3>
<p>A <strong>failed to start concentrator</strong> error means that the <strong>start procedure of the LoRa concentrator has failed</strong>. It can be due to several errors:</p>
<ul>
  <li>The <strong>communication with the device failed</strong>. This can happen, for example:
    <ul>
      <li>if you’re using a build for the wrong gateway ;</li>
      <li>if you’ve made your own build, and that the communication interface (SPI-based, or FTDI-based) was not set up properly ;</li>
      <li>if some obstacle is preventing communication between the process and the concentrator. For example, if your concentrator needs a <a href="https://github.com/TheThingsNetwork/packet_forwarder/blob/develop/docs/INSTALL_INSTRUCTIONS/IMST_RPI.md#pin-reset">reset before usage</a>, or if the interface needs to be <a href="https://www.thethingsnetwork.org/forum/t/pause-or-stop-packet-forwarding-on-kerlink/5352/2">enabled before usage</a>.</li>
    </ul>
  </li>
  <li>The LoRa concentrator is not <strong>configured properly</strong>. For examlpe, some gateways require additional <a href="https://github.com/TheThingsNetwork/packet_forwarder/blob/dd535444e02f5ddd3ca379f2de715d417bde0f0c/pktfwd/configuration.go#L18-L21">configuration steps</a> - consult your gateway’s documentation to know if the packet forwarder needs adaptation steps for this gateway.</li>
</ul>
          </div>
        </div>
      </div>
      <div class="hidden-xs col-sm-2">
        <div class="page-toc page-affix"></div>
      </div>
    </div>
  </div>
</div>
<div class="modal fade" id="lightbox" tabindex="-1" role="dialog">
  <div class="modal-dialog text-center" role="document" style="width:auto;padding:20px;">
    <a href="https://ttnstaticfile.blob.core.windows.net/static/ttn/media/logo/ttn-logo.png"><img class="modal-content modal-body" src="https://ttnstaticfile.blob.core.windows.net/static/ttn/media/logo/ttn-logo.png" alt="Zoom" /></a>
  </div>
</div>
<script src="/docs/assets/js/page.js"></script>
    </div>
    <div id="footer"></div>
    <script src="https://cdn.jsdelivr.net/npm/vue@2.5.13/dist/vue.min.js"></script>
    <script src="https://ttnweb.azureedge.net/static/common/js/ttn-components.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/promise-polyfill@7/dist/polyfill.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/fetch/2.0.3/fetch.min.js"></script>
    <script src="https://ttnweb.azureedge.net/static/common/js/vue-navbar.js"></script>
    <script src="https://ttnweb.azureedge.net/static/common/js/vue-footer.js"></script>
    <script src="https://ttnweb.azureedge.net/static/common/js/ga.js"></script>
  </body>
</html>
